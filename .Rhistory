if (any(class(x) == "difftime")) {
unit <- attr(x, "unit")
}
else {
unit <- " "
}
title(xlab = unit)
}
if (length(x1) < 30) {
abline(h = y, lty = 3)
}
if (box == TRUE) {
boxplot(unclass(x1), add = TRUE, horizontal = TRUE,
axes = FALSE, at = 0.8 * length(sort(x1)),
boxwex = 0.2 * length(sort(x1)))
}
}
}
if (is.numeric(x) | is.integer(x)) {
attributes(x) <- NULL
}
if (is.data.frame(x)) {
heading <- paste(attr(x, "datalabel"), "\n", .No.of.observations,
nrow(x), "\n", "\n", sep = "")
}
if (is.vector(x) | is.vector(unclass(x)) | (is.factor(x)) |
any(class(x) == "POSIXt" | class(x) == "difftime")) {
if (typeof(x) == "character") {
stop(paste(deparse(substitute(x)), "is a character vector"))
}
if (is.factor(x)) {
x <- na.omit(as.numeric(x))
}
if (!is.null(by)) {
by1 <- factor(by, exclude = NULL)
if (any(is.na(levels(by1)))) {
levels(by1)[length(levels(by1))] <- "missing"
}
lev <- levels(by1)
multiple.a <- NULL
for (i in 1:length(lev)) {
x1 <- subset(x, by1 == lev[i])
if (any(class(x1) == "POSIXt")) {
a <- format((summary(x1))[c(1, 3, 4, 6)], "%Y-%m-%d %H:%M")
}
else {
a <- rep("", 6)
dim(a) <- c(1, 6)
if (any(class(x1) == "Date")) {
a[1, ] <- c(length(x1), format(c(summary(x1)[4],
summary(x1)[3], NA, summary(x1)[1], summary(x1)[6]),
"%Y-%m-%d"))
}
else if (any(class(x) == "logical")) {
a[1, ] <- round(c(length(na.omit(x1)), mean(na.omit(x1)),
quantile(na.omit(x1), 0.5), ifelse(is.na(mean(na.omit(x1))),
NA, round(sd(na.omit(x1)), 2)), min(na.omit(x1)),
max(na.omit(x1))), 3)
}
else if (any(class(x) == "difftime")) {
a[1, ] <- round(c(length(na.omit(x1)), mean(na.omit(as.numeric(x1))),
quantile(na.omit(as.numeric(x1)), 0.5),
ifelse(is.na(mean(na.omit(as.numeric(x1)))),
NA, round(sd(na.omit(as.numeric(x1))),
2)), min(na.omit(as.numeric(x1))),
max(na.omit(as.numeric(x1)))), 3)
}
else {
a[1, ] <- round(c(length(na.omit(x1)), summary(x1)[4],
summary(x1)[3], ifelse(is.na(mean(na.omit(x1))),
NA, sd(na.omit(x1))), summary(x1)[1],
summary(x1)[6]), 3)
}
colnames(a) <- c(.obs, .mean, .median, .sd,
.min, .max)
rownames(a) <- " "
}
multiple.a <- rbind(multiple.a, a)
row.names(multiple.a) <- rep("", nrow(multiple.a))
}
}
else {
if (any(class(x) == "POSIXt")) {
a <- (format((summary(x))[c(1, 3, 4, 6)], "%Y-%m-%d %H:%M"))
}
else {
a <- rep("", 6)
dim(a) <- c(1, 6)
if (any(class(x) == "Date")) {
a[1, ] <- c(length(na.omit(x)), format(c(summary(x)[4],
summary(x)[3], NA, summary(x)[1], summary(x)[6]),
"%Y-%m-%d"))
}
else if (any(class(x) == "difftime")) {
a[1, ] <- c(length(na.omit(x)), summary(as.numeric(x))[4],
summary(as.numeric(x))[3], ifelse(is.na(mean(na.omit(x1))),
NA, round(sd(na.omit(x1)), 2)), summary(as.numeric(x))[1],
summary(as.numeric(x))[6])
}
else {
a[1, ] <- round(c(length(na.omit(x)), mean(na.omit(x)),
quantile(na.omit(x), 0.5), ifelse(is.na(mean(na.omit(x))),
NA, round(sd(na.omit(x)), 2)), min(na.omit(x)),
max(na.omit(x))), 3)
}
colnames(a) <- c(.obs, .mean, .median, .sd, .min,
.max)
rownames(a) <- " "
}
}
}
else if (is.recursive(x) && length(x) == 1) {
a <- summary(x)
}
else if (!is.recursive(x) && !is.vector(x) && !is.factor(x))
a <- summary(x)
else {
a <- rep("", (dim(x)[2]) * 7)
dim(a) <- c(dim(x)[2], 7)
colnames(a) <- c(.var.name, .obs, .mean, .median, .sd,
.min, .max)
a[, 1] <- attr(x, "names")
rownames(a) <- 1:nrow(a)
for (i in 1:(dim(x)[2])) {
if ((typeof(x[i][1, ]) == "character") || is.na(mean(na.omit(as.numeric(x[[i]]))))) {
a[i, 3:7] <- ""
}
else {
if (any(class(x[[i]]) == "Date")) {
a[i, c(3, 4, 6, 7)] <- format(c(summary(x[[i]])[4],
summary(x[[i]])[3], summary(x[[i]])[1], summary(x[[i]])[6]),
"%Y-%m-%d")
a[i, 5] <- NA
a[i, 2] <- length((x[[i]])[!is.na(x[[i]])])
}
else if (any(class(x[[i]]) == "POSIXt")) {
a[i, c(3, 4, 6, 7)] <- format(c(summary(x[[i]])[4],
summary(x[[i]])[3], summary(x[[i]])[1], summary(x[[i]])[6]),
"%Y-%m-%d %H:%M")
a[i, 5] <- NA
a[i, 2] <- length((x[[i]])[!is.na(x[[i]])])
}
else if (any(class(x[[i]]) == "difftime")) {
a[i, c(3, 4, 6, 7)] <- c(summary(as.numeric(x[[i]]))[c(4,
3, 1, 6)])
a[i, 5] <- round(sd(x[[i]], na.rm = TRUE),
2)
a[i, 2] <- length((x[[i]])[!is.na(x[[i]])])
}
else if (suppressWarnings(is.integer(x[[i]]) ||
is.numeric(x[[i]]) | (is.logical(x[[i]]) &
!is.na(mean(na.omit(as.numeric(x[[i]]))))))) {
a[i, 3:7] <- round(c(mean(na.omit(x[[i]])),
quantile(na.omit(x[[i]]), 0.5), sd(na.omit(x[[i]])),
min(na.omit(x[[i]])), max(na.omit(x[[i]]))),
2)
a[i, 2] <- as.character(length(na.omit(as.numeric(x[[i]]))))
}
else if (is.null(class(x[[i]]))) {
a[i, 3:7] <- round(c(mean(na.omit(as.numeric(x[[i]]))),
quantile(na.omit(as.numeric(x[[i]])), 0.5),
sd(na.omit(as.numeric(x[[i]]))), min(na.omit(as.numeric(x[[i]]))),
max(na.omit(as.numeric(x[[i]])))), 2)
a[i, 2] <- as.character(length(na.omit(x[[i]])))
}
else if (is.factor(x[i][2, ])) {
a[i, 2] <- as.character(length(na.omit(x[[i]])))
a[i, 3:7] <- round(c(mean(na.omit(unclass(x[i][,
]))), median(na.omit(unclass(x[i][, ]))),
sd(na.omit(unclass(x[i][, ]))), min(na.omit(unclass(x[i][,
]))), max(na.omit(unclass(x[i][, ])))),
3)
}
}
}
}
if (is.data.frame(x)) {
results <- list(heading = heading, table = a)
class(results) <- c("summ", "table")
results
}
else {
if (is.null(by)) {
if (class(a) == "matrix") {
results <- list(table = a)
class(results) <- c("summ", "matrix")
results
}
else {
results <- list(object = a)
class(results) <- c("summ", class(a))
results
}
}
else {
results <- list(byname = deparse(substitute(by)),
levels = levels(factor(by)), table = multiple.a)
class(results) <- c("summ", "list")
results
}
}
}
summ_mod(time.expose)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
summ_mod(time.expose)
time.pretty <- seq(from = x[which.min(x)], to = x[which.min(x)],
by = step)
x[which.min(x)]
x[which.min(x)]
summ
source('~/.active-rstudio-document')
time.pretty <- seq(from = x[which.min(x)], to = x[which.min(x)],
by = step)
summ_mod(time.expose)
summary(x)
time.pretty <- seq(from = x[which.min(x)], to = x[which.min(x)],
by = step)
?seq.POSIXt
time.pretty <- seq(from = x[which.min(x)], to = x[which.min(x)])
time.pretty <- seq(from = x[which.min(x)], to = x[which.min(x)],
by="min")
source('~/.active-rstudio-document')
summ_mod(time.expose)
a <- (format((summary(x))[c(1, 3, 4, 6)], "%Y-%m-%d %H:%M"))
summary(x))[c(1, 3, 4, 6)]
summary(x))[c(1, 3, 4, 6)])
summary(x)[c(1, 3, 4, 6)]
?format
x[which.min(x)]
summary(x)
summary(x)[3]
summary(x)[4]
summary(x)[5]
summary(x)[6]
source('~/.active-rstudio-document')
summ_mod(x)
source('~/.active-rstudio-document')
summ_mod(x)
source('~/.active-rstudio-document')
summ_mod(x)
summ_mod(time.expose)
time.expose<-ISOdatetime(year=1990,month=8,day=day.exptime,hour=hr.exptime,min=min.exptime,sec=0)
summ_mod(time.expose)
summ_mod(time.expose)
(-8/5)/((-8/5)+2)
-4+5
4*4
log10(0.05)
-log10(0.05)
-log10(0.01)
-log10(0.00001)
vars <- c(177, 163, 180, 150, 170, 159, 173, 175)
var(vars)
(var(vars))^2
sqrt(var(vars))
sd(vars)
var(vars)
?var
cov(vars)
install.packages("FinCal")
library("FinCal")
coefficient.variation(sd(vars), mean(vars))
shapiro.test(vars)
vars <- c(55,60,67,67,70,70,70,7073,76,80,80)
shapiro.test(vars)
n = 1000
print(n * log(n))
print(log2(n))
2%%2
20%%2
2%%100
data(ChickWeight)
datos <- ChickWeight
View(ChickWeight)
source('~/.active-rstudio-document')
source('~/.active-rstudio-document')
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.12")
32+166+121+322+234+247+147+446+59+238+21+430+350+385+232+211+393+174+270+636+632+1068+338+734+337+12
35-26.95
library(combinat)
combn(3, 2)
?combn
choose(3,2)
choose(4,2)
choose(5,0)
choose(0,5)
choose(0,111)
choose(5,0)
0.007^0
(4/7) / (3/7)
((4/7) / (3/7)) * 3
library(Biobase)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("AgiMicroRna")
library(AgiMicroRna)
library(AgiMicroRna)
BiocManager::install("affycoretools")
library(affycoretools)
install.packages('https://cran.r-project.org/src/contrib/Archive/ff/ff_2.2-14.tar.gz ',repos=NULL)
install.packages('https://cran.r-project.org/src/contrib/Archive/ff/ff_2.2-14.tar.gz')
install.packages("~/Downloads/ff_2.2-14.tar.gz", repos = NULL, type = "source")
library(GGally)
detach("package:GGally", unload = TRUE)
remove.packages("GGally")
2%%2
2%%14
14%%14
15%%14
10%%2
0%%14
1%%14
1%%15
15%%15
library(cogena)
data(Psoriasis)
sampleLabel
names(sampleLabel)
typeof(sampleLabel)
setwd("~/OneDrive - UNIVERSIDAD NACIONAL AUTÓNOMA DE MÉXICO/owncloud/Documentos/Clases Doctorado Biomedicas/BIOLOGIA DE SISTEMAS/Proyectos/COVID/COVID")
setwd("~/OneDrive - UNIVERSIDAD NACIONAL AUTÓNOMA DE MÉXICO/owncloud/Documentos/Clases Doctorado Biomedicas/BIOLOGIA DE SISTEMAS/Proyectos/COVID/COVID")
library(GEOquery)
library(Biobase)
library(DESeq2)
library(dplyr)
library(org.Mm.eg.db)
library(gage)
gset <- getGEO("GSE162113", GSEMatrix =TRUE)
###GPL21290 contains data for Homo Sapiens
###GPL21493 contains data fort Mus musculos
data_human <- gset$`GSE162113-GPL21290_series_matrix.txt.gz`
data_mouse <- gset$`GSE162113-GPL21493_series_matrix.txt.gz`
###PhenoData
phenodata_human <- pData(data_human)
phenodata_mouse <- pData(data_mouse)
##Expression data
##Expression is obtained from the provided matrix at GEO
datos_raton_dia3 <- read.delim("Raw_data/GSE162113_day3_raw_counts.txt")
###El chido es el dia 7
datos_raton_dia7 <- read.delim("Raw_data/GSE162113_day7_raw_counts.txt")
###Los controles son los eGFP
#######FUNCIONES AUXILIARES QUE RECIBEN EL DF Y  EL TEJIDO DE ORIGEN, DEVUELVEN
###UN DF CON EL CONTROL DEL TEJIDO DE ORIGEN Y EL CASO CON EL TEJIDO DE ORIGEN
##El tejido de origen puede ser: "Heart","Kidney","Lung","Spleen"
###Para los controles
aux_control <- function(datos, tejido_origen){
index_tejido <- grep(tejido_origen, colnames(datos))
index_control <- grep("eGFP", colnames(datos))
index_final <- intersect(index_control, index_tejido)
return(datos[,index_final])
}
###Para los casos
aux_casos <- function(datos, tejido_origen){
index_tejido <- grep(tejido_origen, colnames(datos))
index_casos <- grep("hACE2", colnames(datos))
index_final <- intersect(index_casos, index_tejido)
return(datos[,index_final])
}
###Test de las funciones auxiliares
##El tejido de origen puede ser: "Heart","Kidney","Lung","Spleen"
##NOT RUN
#test <- aux_control(datos_raton_dia7,"Kidney")
#test2 <- aux_casos(datos_raton_dia7,"Spleen")
####Diff exp between organs
#########Heart
#########
#########
#########
heart_controles <- aux_control(datos_raton_dia7,"Heart")
heart_casos <- aux_casos(datos_raton_dia7,"Heart")
heart_counts <- as.matrix(cbind(heart_controles, heart_casos))
condition <- factor(c( rep(c("control","enfermos"),
c(ncol(heart_controles),
ncol(heart_casos)))))
coldata <- data.frame(row.names=colnames(heart_counts), condition)
dds <- DESeqDataSetFromMatrix(countData=heart_counts,
colData=coldata,
design=~condition)
dds$condition <- relevel(dds$condition, ref="control")
dds <- DESeq(dds, parallel = TRUE)
####Obtener todos los resultados y quedarse solo con los significativos
res_heart <- as.data.frame(results(dds))
res_heart <- filter(res_heart, padj < 0.05)
####################END HEART
####################
####################
################Kidney
controles <- aux_control(datos_raton_dia7,"Kidney")
casos <- aux_casos(datos_raton_dia7,"Kidney")
counts <- as.matrix(cbind(controles, casos))
condition <- factor(c( rep(c("control","enfermos"),
c(ncol(controles),
ncol(casos)))))
coldata <- data.frame(row.names=colnames(counts), condition)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=coldata,
design=~condition)
dds$condition <- relevel(dds$condition, ref="control")
dds <- DESeq(dds, parallel = TRUE)
####Obtener todos los resultados y quedarse solo con los significativos
res <- as.data.frame(results(dds))
res_kidney <- filter(res, padj < 0.05)
####################END Kidney
####################
####################
################Lung
controles <- aux_control(datos_raton_dia7,"Lung")
casos <- aux_casos(datos_raton_dia7,"Lung")
counts <- as.matrix(cbind(controles, casos))
condition <- factor(c( rep(c("control","enfermos"),
c(ncol(controles),
ncol(casos)))))
coldata <- data.frame(row.names=colnames(counts), condition)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=coldata,
design=~condition)
dds$condition <- relevel(dds$condition, ref="control")
dds <- DESeq(dds, parallel = TRUE)
####Obtener todos los resultados y quedarse solo con los significativos
res <- as.data.frame(results(dds))
res_lung <- filter(res, padj < 0.05)
####################END Lung
####################
####################
################Spleen
controles <- aux_control(datos_raton_dia7,"Spleen")
casos <- aux_casos(datos_raton_dia7,"Spleen")
counts <- as.matrix(cbind(controles, casos))
condition <- factor(c( rep(c("control","enfermos"),
c(ncol(controles),
ncol(casos)))))
coldata <- data.frame(row.names=colnames(counts), condition)
dds <- DESeqDataSetFromMatrix(countData=counts,
colData=coldata,
design=~condition)
dds$condition <- relevel(dds$condition, ref="control")
dds <- DESeq(dds, parallel = TRUE)
####Obtener todos los resultados y quedarse solo con los significativos
res <- as.data.frame(results(dds))
res_spleen <- filter(res, padj < 0.05)
####################END Spleen
####################
####################
####Guardar resultados de diff exp en csv
write.csv(res_heart,"Diff_Exp/res_heart.csv")
write.csv(res_kidney,"Diff_Exp/res_kidney.csv")
write.csv(res_lung,"Diff_Exp/res_lung.csv")
write.csv(res_spleen,"Diff_Exp/res_spleen.csv")
###Venn diagrams will be plotted using Venny 2.1
###(https://bioinfogp.cnb.csic.es/tools/venny/)
#####Transcritos compartidos en todos los organos
t_compartidos <- Reduce(intersect, list(rownames(res_heart),
rownames(res_kidney),
rownames(res_lung),
rownames(res_spleen)))
#####Transcritos unicos de Heart
heart_unicos <- setdiff(rownames(res_heart),
c(rownames(res_kidney),
rownames(res_lung),
rownames(res_spleen)))
#####Transcritos unicos de Kidney
kidney_unicos <- setdiff(rownames(res_kidney),
c(rownames(res_heart),
rownames(res_lung),
rownames(res_spleen)))
#####Transcritos unicos de Lung
lung_unicos <- setdiff(rownames(res_lung),
c(rownames(res_heart),
rownames(res_kidney),
rownames(res_spleen)))
#####Transcritos unicos de Spleen
spleen_unicos <- setdiff(rownames(res_spleen),
c(rownames(res_heart),
rownames(res_kidney),
rownames(res_lung)))
####La red se hará con los datos de MouseNet V2
##https://www.inetbio.org/mousenet/
datos_network <- read.delim("Raw_data/MouseNetV2_symbol.txt",
header = FALSE)
###Red de Heart con todos los diff exp en res_heart
red_heart <- filter(datos_network,
V1 %in% rownames(res_heart))
red_heart <- filter(red_heart, V2 %in% rownames(res_heart))
write.csv(red_heart,"Networks_files/All_genes/network_heart.csv")
###Red de Kidney con todos los diff exp en res_kidney
red_kidney <- filter(datos_network,
V1 %in% rownames(res_kidney))
red_kidney <- filter(red_kidney, V2 %in% rownames(res_kidney))
write.csv(red_kidney,"Networks_files/All_genes/network_kidney.csv")
###Red de Lung con todos los diff exp en res_lung
red_lung <- filter(datos_network,
V1 %in% rownames(res_lung))
red_lung <- filter(red_lung, V2 %in% rownames(res_lung))
write.csv(red_lung,"Networks_files/All_genes/network_lung.csv")
###Red de Spleen con todos los diff exp en res_spleen
red_spleen <- filter(datos_network,
V1 %in% rownames(res_spleen))
red_spleen <- filter(red_spleen, V2 %in% rownames(res_spleen))
write.csv(red_spleen,"Networks_files/All_genes/network_spleen.csv")
rownames(res_spleen)
red_compartidos <- filter(datos_network,
V1 %in% t_compartidos)
colnames(datos_network)
colnames(datos_network)[3,]
colnames(datos_network)[3,]
datos_network[3,]
red_compartidos <- filter(red_compartidos,
V2 %in% t_compartidos)
write.csv(red_compartidos,"Networks_files/All_genes/network_all.csv")
